<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Careme Locations</title>
  <style>
    body{font-family:system-ui,-apple-system,sans-serif;margin:2rem;background:#f5f7fa;color:#222}
    pre{background:#111;color:#eee;padding:1rem;border-radius:8px;overflow-x:auto;white-space:pre-wrap;word-break:break-word;font-size:.9rem;line-height:1.3}
    form{margin-bottom:1.5rem;display:flex;gap:.5rem}
    input[type=text]{flex:1;padding:.6rem .8rem;border:1px solid #bbb;border-radius:4px;font-size:1rem}
    button{background:#2563eb;color:#fff;border:0;padding:.6rem 1rem;border-radius:4px;cursor:pointer;font-size:1rem}
    button:hover{background:#1d4ed8}
    button.favorite-btn{background:#22c55e;font-size:.9rem;padding:.5rem .75rem;margin-left:.5rem}
    button.favorite-btn:hover{background:#16a34a}
    button.favorite-btn.active{background:#f59e0b}
    button.favorite-btn.active:hover{background:#d97706}
    h1{margin-top:0}
    footer{margin-top:2rem;font-size:.75rem;color:#666}
    ul{list-style:none;padding:0;margin:1rem 0}
    li{margin:0 0 .75rem 0;background:#fff;border:1px solid #e2e2e2;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
    .location-item{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;min-height:44px;box-sizing:border-box}
    .location-link{flex:1;text-decoration:none;color:#222;font-size:1.1rem;line-height:1.4}
    .location-link:hover{color:#2563eb}
    @media (max-width: 768px){body{margin:1rem}.location-item{padding:1.25rem;font-size:1.2rem;min-height:48px;flex-direction:column;align-items:flex-start;gap:.75rem}button.favorite-btn{margin-left:0}}
  </style>
  {{.ClarityScript}}
</head>
<body>
  <h1>Locations near {{.Zip}}</h1>
  <ul>
    {{range .Locations}}
      <li>
        <div class="location-item">
          <a href="/recipes?location={{.ID}}" class="location-link">{{.Name}}, {{.Address}}</a>
          {{if $.User}}
          <form method="POST" action="/user/favorite-store?redirect={{$.Zip | printf "/locations?zip=%s"}}" style="margin:0;display:inline">
            <input type="hidden" name="store_id" value="{{.ID}}">
            <button type="submit" class="favorite-btn{{if eq $.User.FavoriteStore .ID}} active{{end}}">
              {{if eq $.User.FavoriteStore .ID}}★ Favorite{{else}}☆ Set as Favorite{{end}}
            </button>
          </form>
          {{end}}
        </div>
      </li>
    {{end}}
  </ul>
</body>
</html>